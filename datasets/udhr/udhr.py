# coding=utf-8
# Copyright 2020 HuggingFace Datasets Authors.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Lint as: python3
"""Universal Declaration of Human Rights"""

from __future__ import absolute_import, division, print_function

import os
import xml.etree.ElementTree as ET

import datasets


_DESCRIPTION = """\
The Universal Declaration of Human Rights (UDHR) is a milestone document in the history of human rights. Drafted by
representatives with different legal and cultural backgrounds from all regions of the world, it set out, for the
first time, fundamental human rights to be universally protected. The Declaration was adopted by the UN General
Assembly in Paris on 10 December 1948 during its 183rd plenary meeting. The dataset includes translations of the
document in 464 languages and dialects.

© 1996 – 2009 The Office of the High Commissioner for Human Rights

This plain text version prepared by the “UDHR in Unicode” project, https://www.unicode.org/udhr.
"""

_LANGUAGES = {
    "bci": "Baoulé",
    "kri": "Krio",
    "nya_chinyanja": "Nyanja (Chinyanja)",
    "009": "Mbundu (009)",
    "fon": "Fon",
    "hat_kreyol": "Haitian Creole French (Kreyol)",
    "vie": "Vietnamese",
    "tgl": "Tagalog",
    "oci_4": "Occitan (Francoprovençal, Valais)",
    "dag": "Dagbani",
    "tha2": "Thai (2)",
    "kkh_lana": "Khün",
    "quz": "Quechua, Cusco",
    "qva": "Quechua, Ambo",
    "ckb": "Kurdish, Central",
    "arb": "Arabic, Standard",
    "fuv": "Fulfulde, Nigerian",
    "hun": "Hungarian",
    "hak": "Chinese, Hakka",
    "aii": "Assyrian Neo",
    "sun": "Sunda",
    "hns": "Hindustani, Sarnami",
    "xho": "Xhosa",
    "ady": "Adyghe",
    "vep": "Veps",
    "008": "Crioulo, Upper Guinea (008)",
    "gkp": "Kpelle, Guinea",
    "epo": "Esperanto",
    "est": "Estonian",
    "020": "Drung",
    "nba": "Nyemba",
    "piu": "Pintupi",
    "kqs": "Kissi, Northern",
    "lao": "Lao",
    "kea": "Kabuverdianu",
    "kde": "Makonde",
    "mal_chillus": "Malayalam",
    "yue": "Chinese, Yue",
    "isl": "Icelandic",
    "nya_chechewa": "Nyanja (Chechewa)",
    "hat_popular": "Haitian Creole French (Popular)",
    "bug": "Bugis",
    "dyu": "Jula",
    "ajg": "Aja",
    "miq": "Mískito",
    "roh_surmiran": "Romansch (Surmiran)",
    "quy": "Quechua, Ayacucho",
    "tha": "Thai",
    "qvc": "Quechua, Cajamarca",
    "sot": "Sotho, Southern",
    "cjs": "Shor",
    "tir": "Tigrigna",
    "sah": "Yakut",
    "hva": "Huastec (San Luís Potosí)",
    "swe": "Swedish",
    "dzo": "Dzongkha",
    "afr": "Afrikaans",
    "btb": "Bulu",
    "nan": "Chinese, Min Nan",
    "ltz": "Luxembourgeois",
    "lin_tones": "Lingala (tones)",
    "wwa": "Waama",
    "cmn_hant": "Chinese, Mandarin (Traditional)",
    "lnc": "Occitan (Languedocien)",
    "lot": "Otuho",
    "kir": "Kirghiz",
    "kha": "Khasi",
    "khk_mong": "Mongolian, Halh (Mongolian)",
    "tuk_latn": "Turkmen (Latin)",
    "yap": "Yapese",
    "oki": "Okiek",
    "mri": "Maori",
    "agr": "Aguaruna",
    "oci_2": "Occitan (Francoprovençal, Savoie)",
    "mic": "Micmac",
    "fuf": "Pular",
    "tiv": "Tiv",
    "slk": "Slovak",
    "smo": "Samoan",
    "tgk": "Tajiki",
    "tet": "Tetun",
    "oci_3": "Occitan (Francoprovençal, Vaud)",
    "tsn": "Tswana",
    "fuf_adlm": "Pular (Adlam)",
    "ell_polytonic": "Greek (polytonic)",
    "026": "(Yeonbyeon)",
    "wln": "Walloon",
    "pis": "Pijin",
    "ese": "Ese Ejja",
    "buc": "Bushi",
    "chr_cased": "Cherokee (cased)",
    "nym": "Nyamwezi",
    "lob": "Lobi",
    "kjh": "Khakas",
    "lns": "Lamnso'",
    "yua": "Maya, Yucatán",
    "bcl": "Bicolano, Central",
    "roh_sursilv": "Romansch (Sursilvan)",
    "blt": "Tai Dam",
    "cmn_hans": "Chinese, Mandarin (Simplified)",
    "lun": "Lunda",
    "krl": "Karelian",
    "nob": "Norwegian, Bokmål",
    "yad": "Yagua",
    "vec": "Venetian",
    "csa": "Chinantec, Chiltepec",
    "swb": "Comorian, Maore",
    "orh": "Oroqen",
    "oci_1": "Occitan (Francoprovençal, Fribourg)",
    "zdj": "Comorian, Ngazidja",
    "ast": "Asturian",
    "chk": "Chuukese",
    "fur": "Friulian",
    "chj": "Chinantec, Ojitlán",
    "sna": "Shona",
    "qxn": "Quechua, Northern Conchucos Ancash",
    "san": "Sanskrit",
    "crs": "Seselwa Creole French",
    "suk": "Sukuma",
    "csw": "Cree, Swampy",
    "tsz": "Purepecha",
    "hna": "Mina",
    "not": "Nomatsiguenga",
    "vie_han": "Vietnamese (Han nom)",
    "blu": "Hmong Njua",
    "nyn": "Nyankore",
    "mly_latn": "Malay (Latin)",
    "kbp": "Kabiyé",
    "guc": "Wayuu",
    "roh_rumgr": "Romansch (Grischun)",
    "glv": "Manx",
    "gla": "Gaelic, Scottish",
    "nep": "Nepali",
    "hea": "Hmong, Northern Qiandong",
    "amc": "Amahuaca",
    "cab": "Garifuna",
    "maz": "Mazahua Central",
    "mam": "Mam, Northern",
    "mal": "Malayalam",
    "mcd": "Sharanahua",
    "shp": "Shipibo",
    "jiv": "Shuar",
    "cat": "Catalan",
    "deu_1901": "German, Standard (1901)",
    "spa": "Spanish",
    "uig_latn": "Uyghur (Latin)",
    "pov": "Crioulo, Upper Guinea",
    "gag": "Gagauz",
    "ilo": "Ilocano",
    "guu": "Yanomamö",
    "ron_1953": "Romanian (1953)",
    "kng": "Koongo",
    "kbd": "Kabardian",
    "evn": "Evenki",
    "mto": "Mixe, Totontepec",
    "ztu": "Zapotec, Güilá",
    "fin": "Finnish",
    "als": "Albanian, Tosk",
    "rmn_1": "Romani, Balkan (1)",
    "heb": "Hebrew",
    "ayr": "Aymara, Central",
    "top": "Totonac, Papantla",
    "mcf": "Matsés",
    "mos": "Mòoré",
    "mnw": "Mon",
    "tam": "Tamil",
    "run": "Rundi",
    "ind": "Indonesian",
    "ron_1993": "Romanian (1993)",
    "bho": "Bhojpuri",
    "bel": "Belarusan",
    "uzn_cyrl": "Uzbek, Northern (Cyrillic)",
    "kaz": "Kazakh",
    "niu": "Niue",
    "pam": "Pampangan",
    "tam_LK": "Tamil (Sri Lanka)",
    "ykg": "Yukaghir, Northern",
    "pnb": "Panjabi, Western",
    "glg": "Galician",
    "bre": "Breton",
    "tzc": "Tzotzil (Chamula)",
    "ame": "Yaneshaʼ",
    "mxi": "Mozarabic",
    "amr": "Amarakaeri",
    "tca": "Ticuna",
    "ddn": "Dendi",
    "fra": "French",
    "tly": "Talysh",
    "tob": "Toba",
    "auc": "Waorani",
    "aka_fante": "Fante",
    "bos_cyrl": "Bosnian (Cyrillic)",
    "tah": "Tahitian",
    "cbi": "Chachi",
    "fij": "Fijian",
    "ctd": "Chin, Tedim",
    "abk": "Abkhaz",
    "ibb": "Ibibio",
    "nds": "Saxon, Low",
    "ina": "Interlingua",
    "pcd": "Picard",
    "njo": "Naga, Ao",
    "gaa": "Ga",
    "bin": "Edo",
    "pes_2": "Dari",
    "kal": "Inuktitut, Greenlandic",
    "bem": "Bemba",
    "knc": "Kanuri, Central",
    "lia": "Limba, West",
    "bfa": "Bari",
    "nso": "Sotho, Northern",
    "lit": "Lithuanian",
    "kor": "Korean",
    "gyr": "Guarayu",
    "kan": "Kannada",
    "lat_1": "Latin (1)",
    "pbb": "Páez",
    "pbu": "Pashto, Northern",
    "pan": "Panjabi, Eastern",
    "gld": "Nanai",
    "eus": "Basque",
    "aar": "Afar",
    "dga": "Dagaare, Southern",
    "ccx": "Zhuang, Yongbei",
    "taj": "Tamang, Eastern",
    "mah": "Marshallese",
    "cnh": "Chin, Haka",
    "srp_cyrl": "Serbian (Cyrillic)",
    "cni": "Asháninka",
    "auv": "Occitan (Auvergnat)",
    "mai": "Maithili",
    "azj_latn": "Azerbaijani, North (Latin)",
    "alt": "Altai, Southern",
    "fkv": "Finnish, Kven",
    "ven2": "Venda",
    "vai": "Vai",
    "gle": "Gaelic, Irish",
    "pes_1": "Farsi, Western",
    "rmn": "Romani, Balkan",
    "rmy": "Aromanian",
    "gug": "Guaraní, Paraguayan",
    "ben": "Bengali",
    "ita": "Italian",
    "koi": "Komi",
    "ukr": "Ukrainian",
    "guj": "Gujarati",
    "pau": "Palauan",
    "gax": "Oromo, Borana",
    "cym": "Welsh",
    "zul": "Zulu",
    "cak": "Kaqchikel, Central",
    "por_PT": "Portuguese (Portugal)",
    "hrv": "Croatian",
    "mlt": "Maltese",
    "mad": "Madura",
    "tzm_tfng": "Tamazight, Central Atlas (Tifinagh)",
    "mar": "Marathi",
    "shn": "Shan",
    "dip": "Dinka, Northeastern",
    "tyv": "Tuva",
    "tzm": "Tamazight, Central Atlas",
    "eve": "Even",
    "rus": "Russian",
    "ktu": "Kituba",
    "gan": "Chinese, Gan",
    "kat": "Georgian",
    "tuk_cyrl": "Turkmen (Cyrillic)",
    "lin": "Lingala",
    "kmb": "Mbundu",
    "roh": "Romansch",
    "ydd": "Yiddish, Eastern",
    "ibo": "Igbo",
    "urd": "Urdu",
    "acu": "Achuar",
    "ami": "Amis",
    "mya": "Burmese",
    "cbs": "Cashinahua",
    "hsf": "Huastec (Sierra de Otontepec)",
    "mag": "Magahi",
    "cot": "Caquinte",
    "ton": "Tongan",
    "cbr": "Cashibo",
    "ote": "Otomi, Mezquital",
    "src": "Sardinian, Logudorese",
    "amh": "Amharic",
    "jav_java": "Javanese (Javanese)",
    "nio": "Nganasan",
    "eml": "Romagnolo",
    "roh_sutsilv": "Romansch (Sutsilvan)",
    "koo": "Konjo",
    "kwi": "Awa",
    "ura": "Urarina",
    "plt": "Malagasy, Plateau",
    "tur": "Turkish",
    "sey": "Secoya",
    "cof": "Colorado",
    "skr": "Seraiki",
    "toj": "Tojolabal",
    "fri": "Frisian, Western",
    "div": "Maldivian",
    "hsb": "Sorbian, Upper",
    "tbz": "Ditammari",
    "oaa": "Orok",
    "vmw": "Makhuwa",
    "mzi": "Mazatec, Ixcatlán",
    "mxv": "Mixtec, Metlatónoc",
    "hil": "Hiligaynon",
    "pon": "Pohnpeian",
    "pcm": "Pidgin, Nigerian",
    "nhn": "Nahuatl, Central",
    "nku": "Kulango, Bouna",
    "kng_AO": "Koongo (Angola)",
    "lij": "Ligurian",
    "rar": "Rarotongan",
    "eng": "English",
    "emk": "Maninkakan, Eastern",
    "fuv2": "Fulfulde, Nigerian (2)",
    "pap": "Papiamentu",
    "ewe": "Éwé",
    "ndo": "Ndonga",
    "pol": "Polish",
    "jpn": "Japanese",
    "hin": "Hindi",
    "ssw": "Swati",
    "cbu": "Candoshi",
    "tat": "Tatar",
    "sin": "Sinhala",
    "shk": "Shilluk",
    "toi": "Tonga",
    "cos": "Corsican",
    "zam": "Zapotec, Miahuatlán",
    "cbt": "Chayahuita",
    "ccp": "Chakma",
    "srr": "Serer",
    "aka_asante": "Twi (Asante)",
    "tzh": "Tzeltal, Oxchuc",
    "ace": "Aceh",
    "bis": "Bislama",
    "kmr": "Kurdish, Northern",
    "wuu": "Chinese, Wu",
    "wol": "Wolof",
    "014": "(Maiunan)",
    "ido": "Ido",
    "ojb": "Ojibwa, Northwestern",
    "bos_latn": "Bosnian (Latin)",
    "por_BR": "Portuguese (Brazil)",
    "mkd": "Macedonian",
    "tem": "Themne",
    "dan": "Danish",
    "xsm": "Kasem",
    "cjk_AO": "Chokwe (Angola)",
    "hye": "Armenian",
    "hau_NE": "Hausa (Niger)",
    "qvh": "Quechua, Huamalíes",
    "jav": "Javanese (Latin)",
    "cic": "Chickasaw",
    "qud": "Quechua (Unified Quichua, old Hispanic orthography)",
    "men": "Mende",
    "cjy": "Chinese, Jinyu",
    "qxu": "Quechua, Arequipa",
    "tel": "Telugu",
    "crh": "Crimean Tatar",
    "ven": "Venda",
    "san_gran": "Sanskrit (Grantha)",
    "bul": "Bulgarian",
    "acu_1": "Achuar",
    "iii": "Nuosu",
    "uzn_latn": "Uzbek, Northern (Latin)",
    "urd_2": "Urdu (2)",
    "prv": "Occitan",
    "loz": "Lozi",
    "khm": "Khmer, Central",
    "lad": "Ladino",
    "lua": "Luba",
    "tso_MZ": "Tsonga (Mozambique)",
    "017": "(Minjiang, written)",
    "fao": "Faroese",
    "deu_1996": "German, Standard (1996)",
    "cpu": "Ashéninka, Pichis",
    "azj_cyrl": "Azerbaijani, North (Cyrillic)",
    "haw": "Hawaiian",
    "qug": "Quichua, Chimborazo Highland",
    "zgh": "Tamazight, Standard Morocan",
    "hau_NG": "Hausa (Nigeria)",
    "snn": "Siona",
    "ceb": "Cebuano",
    "qxa": "Quechua, South Bolivian",
    "hus": "Huastec (Veracruz)",
    "min": "Minangkabau",
    "sus": "Susu",
    "srp_latn": "Serbian (Latin)",
    "016": "(Minjiang, spoken)",
    "kqn": "Kaonde",
    "war": "Waray",
    "chr_uppercase": "Cherokee (uppercase)",
    "kek": "Q'eqchi'",
    "boa": "Bora",
    "ban": "Bali",
    "lav": "Latvian",
    "nzi": "Nzema",
    "prq": "Ashéninka Perené",
    "lus": "Mizo",
    "yor": "Yoruba",
    "nld": "Dutch",
    "ron_2006": "Romanian (2006)",
    "012": "(Bizisa)",
    "roh_vallader": "Romansch (Vallader)",
    "mly_arab": "Malay (Arabic)",
    "swh": "Swahili",
    "flm": "Chin, Falam",
    "cha": "Chamorro",
    "qvn": "Quechua, North Junín",
    "arl": "Arabela",
    "snk": "Soninke",
    "quc": "K'iche', Central",
    "dyo": "Jola",
    "hlt": "Chin, Matu",
    "ada": "Dangme",
    "007": "Sãotomense",
    "aka_akuapem": "Twi (Akuapem)",
    "013": "(Mijisa)",
    "yao": "Yao",
    "lue": "Luvale",
    "tgl_tglg": "Tagalog (Tagalog)",
    "tso_ZW": "Tsonga (Zimbabwe)",
    "uig_arab": "Uyghur (Arabic)",
    "bod": "Tibetan, Central",
    "bax": "Bamun",
    "bba": "Baatonum",
    "khk": "Mongolian, Halh (Cyrillic)",
    "bam": "Bamanankan",
    "kdh": "Tem",
    "nno": "Norwegian, Nynorsk",
    "ell_monotonic": "Greek (monotonic)",
    "lug": "Ganda",
    "ike": "Inuktitut, Eastern Canadian",
    "nbl": "Ndebele",
    "011": "Umbundu (011)",
    "gjn": "Gonja",
    "hni": "Hani",
    "tpi": "Tok Pisin",
    "roh_puter": "Romansch (Puter)",
    "sme": "Saami, North",
    "mfq": "Moba",
    "arn": "Mapudungun",
    "som": "Somali",
    "slv": "Slovenian",
    "qvm": "Quechua, Margos",
    "cjk": "Chokwe",
    "qwh": "Quechua, Huaylas Ancash",
    "ces": "Czech",
    "sco": "Scots",
    "sag": "Sango",
    "oss": "Osetin",
    "huu": "Huitoto, Murui",
    "zro": "Záparo",
    "hms": "Hmong, Southern Qiandong",
    "010": "Tetun Dili",
    "nav": "Navajo",
    "ppl": "Pipil",
    "lat": "Latin",
    "umb": "Umbundu",
    "lld": "Ladin",
    "kin": "Rwanda",
}

_WEBPAGE = "https://www.ohchr.org/EN/UDHR/Pages/UDHRIndex.aspx"

# XML for meta-info about language and TXT for text
_XML_DOWNLOAD_URL = "https://unicode.org/udhr/assemblies/udhr_xml.zip"
_TXT_DOWNLOAD_URL = "https://unicode.org/udhr/assemblies/udhr_txt.zip"


class UDHN(datasets.GeneratorBasedBuilder):
    """Universal Declaration of Human Rights"""

    def _info(self):
        return datasets.DatasetInfo(
            description=_DESCRIPTION,
            features=datasets.Features(
                {
                    "text": datasets.Value("string"),
                    "lang_key": datasets.Value("string"),
                    "lang_name": datasets.Value("string"),
                    "iso639-3": datasets.Value("string"),
                    "iso15924": datasets.Value("string"),
                }
            ),
            homepage=_WEBPAGE,
        )

    def _split_generators(self, dl_manager):
        xml_dir = dl_manager.download_and_extract(_XML_DOWNLOAD_URL)
        txt_dir = dl_manager.download_and_extract(_TXT_DOWNLOAD_URL)

        return [
            datasets.SplitGenerator(name=datasets.Split.TRAIN, gen_kwargs={"xml_dir": xml_dir, "txt_dir": txt_dir}),
        ]

    def _generate_examples(self, xml_dir, txt_dir):
        for ilang, lang in enumerate(_LANGUAGES):
            xml_path = os.path.join(xml_dir, f"udhr_{lang}.xml")
            lang_attr = ET.parse(xml_path).getroot().attrib

            txt_path = os.path.join(txt_dir, f"udhr_{lang}.txt")
            with open(txt_path, "r", encoding="utf-8") as f:
                lines = f.readlines()[6:]  # ignore first 6 lines (metainfo)
            text = "\n".join([line.strip() for line in lines if len(line.strip()) > 0])

            yield ilang, {
                "text": text,
                "lang_key": lang,
                "lang_name": lang_attr["n"],
                "iso639-3": lang_attr["iso639-3"],
                "iso15924": lang_attr["iso15924"],
            }
